<html>
<script>
  var obj;
  function init() {
    //console.log("a");
    var xmlhttp;
    if (window.XMLHttpRequest) {// code for IE7+, Firefox, Chrome, Opera, Safari
      xmlhttp = new XMLHttpRequest();
    }
    else {// code for IE6, IE5
      xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
    }
    xmlhttp.onreadystatechange = function () {
      if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
        //document.getElementById("test").innerHTML=responseText;
        obj = JSON.parse(xmlhttp.responseText);
        //console.log(obj.list[1].OJ);
      }
    }
    xmlhttp.open("GET", "./listdata.json", true);
    xmlhttp.send();
  }
  window.onload = init();
</script>

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" ID="viewport" />
  <link rel="icon" href="logo.ico" type="logo-icon" />
  <!-- 引入element样式 -->
  <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
  <title>題目列表-XOJ</title>
</head>

<body>
  <div id="listTable">
    <el-menu :default-active="activeIndex2" class="el-menu-demo" mode="horizontal" @select="handleSelect" background-color="#545c64"
      text-color="#fff" active-text-color="#ffd04b">
      <el-menu-item index="3">
        <a href="./lisit.html" target="_blank">HOME</a>
      </el-menu-item>
      <el-menu-item index="3">
        <a href="./submit.html" target="_blank">SUBMIT</a>
      </el-menu-item>
      <el-menu-item index="3">
        <a href="./problem.html" target="_blank">PROBLEM</a>
      </el-menu-item>
      <el-menu-item index="3">
        <a href="./status.html" target="_blank">STATUS</a>
      </el-menu-item>
    </el-menu>
    <el-table :data="list" border style="width: 100%" @cell-click="click">
      <el-table-column prop="OJ" label="OJ" sortable width="180">
      </el-table-column>
      <el-table-column prop="ID" label="ID" width="180">
      </el-table-column>
      <el-table-column prop="Title" label="Title" :formatter="formatter">
      </el-table-column>
      <el-table-column prop="tag" label="难度" width="100" :filters="[{ text: 'Easy', value: 'Easy' }, { text: 'Middle', value: 'Middle' },{text:'Hard',value:'Hard'}]"
        :filter-method="filterTag" filter-placement="bottom-end">
        <template scope="scope">
          <el-tag :type="scope.row.tag === 'Hard' ? 'danger' : 'primary'" close-transition>{{scope.row.tag}}</el-tag>
        </template>
      </el-table-column>
    </el-table>
  </div>
</body>
<!-- 引入vue -->
<script src="https://unpkg.com/vue/dist/vue.js"></script>
<!-- 引入element JS -->
<script src="https://unpkg.com/element-ui/lib/index.js"></script>
<script src="http://cdn.bootcss.com/jquery/3.1.1/jquery.js"></script>
<script type="text/javascript">
    var order = new Vue({
      el: '#listTable',
      data: function () {
        return {
          activeIndex2: '1'
        }
      },
      data() {
        return obj;
      },
      methods: {
        formatter(row, column) {
          return row.Title;
        },
        filterTag(value, row) {
          return row.tag === value;
        },
        click(row, column, cell, event) {
          var pre_text = cell.innerHTML;
          var txt = pre_text.substring(18, pre_text.length - 6);
          var id = row.ID;
          var title = row.title;
          var oj = row.OJ;
          if (txt === oj) {
            //如果点击了OJ列，跳转至对应的OJ首页
            var oj_list = {
              "POJ": "http://poj.org/",
              "HDU": "http://acm.hdu.edu.cn/"
            }
            switch (oj) {
              case "POJ": {
                window.location.href = oj_list.POJ;
                break;
              }
              case "HDU": {
                window.location.href = oj_list.HDU;
                break;
              }
            }

          } else {
            //如果点击了Title或者ID列，跳转进入problem.html
            //turn(oj, id);
            var xmlhttp;
            if (window.XMLHttpRequest) {// code for IE7+, Firefox, Chrome, Opera, Safari
              xmlhttp = new XMLHttpRequest();
            }
            else {// code for IE6, IE5
              xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
            }
            xmlhttp.onreadystatechange = function () {
              if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
                //document.getElementById("test").innerHTML=responseText;
                //obj = JSON.parse(xmlhttp.responseText);
                //console.log(obj.list[1].OJ);
                window.location.href = './problem.html';
                console.log(oj + " " + id + " " + row.Title);
              }
            }
            xmlhttp.open("GET", "./problem.html?oj="+oj+"&pid="+id, true);
            xmlhttp.send();
          }
          console.log(oj + " " + id + " " + row.Title);
          //console.log(txt);
          //console.log(row.ID);
          //console.log(column.label);
        }
      }
    });
</script>
<style>
  body {
    padding-top: 30px;
    padding-left: 10%;
    padding-right: 10%;
    background-image: url(./round.png);
  }
</style>

</html>